<h2>Service Records

<div class='footer'>
    <%= link_to "New Service Record", new_service_record_path %>
</div>

</h2>

<% if !params[:mechanic].blank? %>
  <% @service_records = ServiceRecord.where(mechanic: params[:mechanic]) %>
<% end %>

<div class="search">
  <%= form_tag("/service_records", method: "get") do %>
    <p><%= label_tag ("Filter by Mechanic:") %></p>
    <p><%= select_tag "mechanic", options_from_collection_for_select(Mechanic.all, "id", "name"), include_blank: true %><br></p>
    <p><%= submit_tag "Filter" %></p>
  <% end %>
</div>

<br>

<table>
    <thead>
        <tr>
            <th>Date</th>
            <th>Vehicle</th>
            <th>Vehicle Owner</th>
            <th>Service</th>
            <th>Mechanic</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <% @service_records.each do |service_record| %>
            <tr>
                <td><%= service_record.date_of_service %></td>
                <td><%= service_record.car.make %> <%= service_record.car.model %></td>
                <td><%= service_record.car.owner.name %></td>
                <td><%= service_record.service.service_description %></td>
                <td><%= service_record.mechanic.name %></td>
                <td><%= link_to "View Service Record", service_record_path(service_record) %></td>
            </tr>
        <% end %>
    </tbody>
</table>

<br>

